// Файл: /public/js/interactive-map.js

document.addEventListener('DOMContentLoaded', function() {
    // Инициализация карты
    const map = L.map('map').setView([43.17, 44.80], 9);
    
    // Добавление базового слоя OpenStreetMap
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
        maxZoom: 18
    }).addTo(map);
    
    // Добавление спутникового слоя
    const satelliteLayer = L.tileLayer('https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {
        attribution: '&copy; Google Maps',
        maxZoom: 20
    });
    
    // Базовые слои для выбора
    const baseLayers = {
        "Карта": L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map),
        "Спутник": satelliteLayer
    };
    
    L.control.layers(baseLayers, null, { position: 'topleft' }).addTo(map);
    
    // Создание иконок для различных типов объектов
    const cityIcon = L.divIcon({
        html: '<i class="fas fa-city" style="color: darkgreen; font-size: 20px;"></i>',
        className: 'map-icon',
        iconSize: [20, 20],
        iconAnchor: [10, 10]
    });
    
    const villageIcon = L.divIcon({
        html: '<i class="fas fa-home" style="color: darkgreen; font-size: 16px;"></i>',
        className: 'map-icon',
        iconSize: [16, 16],
        iconAnchor: [8, 8]
    });
    
    const culturalIcon = L.divIcon({
        html: '<i class="fas fa-landmark" style="color: darkblue; font-size: 18px;"></i>',
        className: 'map-icon',
        iconSize: [18, 18],
        iconAnchor: [9, 9]
    });
    
    const religiousIcon = L.divIcon({
        html: '<i class="fas fa-mosque" style="color: red; font-size: 18px;"></i>',
        className: 'map-icon',
        iconSize: [18, 18],
        iconAnchor: [9, 9]
    });
    
    // Функция для создания расширенного всплывающего окна с информацией
    function createExtendedPopupContent(item) {
        let content = `<div class="popup-content">
            <h3>${item.name}</h3>`;
            
        if (item.image) {
            content += `<img src="${item.image}" alt="${item.name}" class="popup-image">`;
        }
        
        content += `<p>${item.description}</p>`;
        
        if (item.history) {
            content += `<p><strong>История:</strong> ${item.history}</p>`;
        }
        
        if (item.population) {
            content += `<p><strong>Население:</strong> ${item.population.toLocaleString()} чел.</p>`;
        }
        
        content += `</div>`;
            
        return content;
    }
    
    // Создаем слои для разных типов объектов
    const citiesLayer = L.layerGroup();
    const villagesLayer = L.layerGroup();
    const culturalLayer = L.layerGroup();
    const religiousLayer = L.layerGroup();
    
    // Города
    const cities = [
        {
            name: "Магас",
            coords: [43.17, 44.81],
            description: "Столица Республики Ингушетия, названа в честь древней столицы Аланского государства.",
            history: "Город назван в честь средневековой столицы Аланского государства. Современный Магас был основан указом президента РФ от 23 февраля 1994 года.",
            image: "/img/settlements/magas.jpg",
            population: 15250
        },
        {
            name: "Наьсаре (Назрань)",
            coords: [43.23, 44.76],
            description: "Крупнейший город Ингушетии, был столицей республики до 2000 года.",
            history: "Назрань - один из старейших населенных пунктов Ингушетии, первое упоминание относится к 1810 году. В 1817 году здесь была основана российская крепость. С 1992 по 2000 год Назрань была столицей Республики Ингушетия.",
            image: "/img/settlements/nazran.jpg",
            population: 122350
        },
        {
            name: "Шолжа-пхье (Сунжа)",
            coords: [43.32, 45.05],
            description: "Город, в котором расположен важнейший и единственный аэропорт Ингушетии - 'Магас'.",
            history: "Датой основания населенного пункта, исходя из наиболее раннего известного достоверного источника, где указано поселение «Корей» (т.е. Курей-юрт),   на правом берегу р. Сунжи к юго-западу от бывшего укрепления Преградный стан (на левом берегу Сунжи), надо считать «не позже» 1825 году. В 2015 году получила статус города и название Сунжа.",
            image: "/img/settlements/sunzha.jpg",
            population: 64500
        },
        {
            name: "Илдарха-ГIaла (Карабулак)",
            coords: [43.31, 44.91],
            description: "Город республиканского значения.",
            history: "Карабулак был основан в 1859 году на месте ингушского поселения.",
            image: "/img/settlements/karabulak.jpg",
            population: 43000
        },
        {
            name: "МагӀалбике (Малгобек)",
            coords: [43.51, 44.59],
            description: "Город на самом севере Ингушетии.",
            history: "Название города происходит от наименования урочища Магиал-Бек, на месте которого возник город. С ингушского этот топоним переводится как «верховный начальник войска» и возводится к титулу былого владельца этих земель",
            image: "/img/settlements/malgobek.jpg",
            population: 36800
        },
        {
            name: "Буро (Владикавказ)",
            coords: [43.03, 44.68],
            description: "Город, исторически населённый ингушами и столица Ингушского автономного округа в 1925-х годах",
            history: "Город основан на ингушском селении Заур, однако с приходои Российской Империи коренное ингушское население вытеснялось из области",
            image: "/img/settlements/vladikavkaz.jpg",
            population: 311600
        }
    ];
    
    // Села
    const villages = [
        {
            name: "Iаьли-Юрт (Али-Юрт)",
            coords: [43.15, 44.85],
            description: "Старинное ингушское село, известное своими традициями и исторической архитектурой.",
            history: "Али-Юрт - один из старейших аулов Ингушетии, основанный в XVI-XVII веках.",
            image: "/img/settlements/ali-yurt.jpg",
            population: 7800
        },
        {
            name: "ДжӀайрахь (Джейрах)",
            coords: [42.82, 44.68],
            description: "Село в горной Ингушетии, районный центр Джейрахского района.",
            history: "Джейрах - центр горной Ингушетии, где сосредоточено большинство исторических и архитектурных памятников средневековой Ингушетии.",
            image: "/img/settlements/dzheyrakh.jpg",
            population: 2000
        },
        {
            name: "Хьули́ (Гули)",
            coords: [42.81, 44.80],
            description: "Историческое ингушское село в горной части Ингушетии.",
            history: "Гули - древнее горное поселение, где сохранились традиционные башенные комплексы.",
            image: "/img/settlements/guli.jpg",
            population: 300
        },
        {
            name: " СурхотӀе, Сурхо-Хитӏе (Сурхахи)",
            coords: [43.19, 44.90],
            description: "Крупное село в Назрановском районе Ингушетии.",
            history: "Село с богатой историей, известное своими традициями и обычаями.",
            image: "/img/settlements/surkhakhi.jpg",
            population: 11700
        },
        {
            name: "Эккажакъонгий-Юрт (Экажево)",
            coords: [43.21, 44.82],
            description: "Одно из крупнейших сельских поселений Ингушетии.",
            history: "Село с давними историческими корнями, известное своими традициями и культурными обычаями.",
            image: "/img/settlements/ekazhevo.jpg",
            population: 22500
        },
        {
            name: "Эбарг-Юрт (Троицкая)",
            coords: [43.30, 44.99],
            description: "Крупная станица в Сунженском районе Ингушетии.",
            history: "Станица Троицкая была основана в 1845 году в рамках создания Сунженской оборонительной линии.",
            image: "/img/settlements/troitskaya.jpg",
            population: 19800
        },
        {
            name: "Черкъий-Юрт, Йоккха Ачалкхе (Ачалуки)",
            coords: [43.37, 44.73],  // Координаты [широта, долгота]
            description: "Общее название Нижних, Средних и Верхних Ачалуков - три густозаселенных села Ингушетии",
            history: "В начале 19 век территория нынешнего села находилась в составе Малой Кабарды. Долина реки Ачалуки была обжита кабардинцами. Первые письменные упоминания о селе Верхние Ачалуки датированы 1820 годом.",
            image: "/img/settlements/achaluki.jpg",
            population: 9000
        },
        {
            name: "Пхьилекъонгий-Юрт (Плиево)",
            coords: [43.29, 44.85],  // Координаты [широта, долгота]
            description: "Село расположено на левом берегу реки Сунжа, восточнее Алханчуртского канала, в 3 км к северо-востоку от районного центра — города Назрань и в 11 км к северу от города Магас.",
            history: "По официальным данным селение Плиево было основано в 1781 году (хотя в научных работах встречается также и более поздняя дата — 1836 год). Первопоселенцами являлись представители тайпа Плиевых, с чем связано и название села (ингуш. Пхьилекъонгий-Юрт буквально означает, по некоторым данным, «село сыновей Пхьиле», то есть, «село Плиевых»)",
            image: "/img/settlements/plievo.jpg",
            population: 17000
        },
        {
            name: "Буро́-Кӏале́ (Барсуки)",
            coords: [43.26, 44.81],  // Координаты [широта, долгота]
            description: "Село расположено у впадения реки Назранка в Сунжу, к северо-востоку от районного центра города Назрань. Основная часть села расположена между Сунжей (на востоке) и Алханчуртским каналом (на западе).",
            history: "село Бурсуки было центром Бурсуковского сельсовета Назрановского района Ингушской автономной области Северо-Кавказского края, к которому также относилась и крепость Назрань.",
            image: "/img/settlements/barsuki.jpg",
            population: 8000
        },
        {
            name: "Яндаре",
            coords: [43.28, 44.91],  // Координаты [широта, долгота]
            description: "Село расположено по обоим берегам реки Яндырка, чуть выше её впадения в Сунжу, в 7,5 км к северо-востоку от районного центра — города Назрань и в 15 км к северо-востоку от города Магас.",
            history: "Территория Яндаре, вместе с селениями Гази-Юрт, Сурхахи, Экажево, Али-Юрт и современным городом Магас, образует один из крупнейших археологических комплексов городищ аланского периода, где по версии ингушских исследователей находился исторический город Магас — столица средневекового государства Алания.",
            image: "/img/settlements/yandire.jpg",
            population: 10000
        },
        {
            name: "ГӀа́жара-Юрт (Нестеровская)",
            coords: [43.24, 45.05],  // Координаты [широта, долгота]
            description: "Станица расположена на левом берегу реки Асса, в 5 км к югу от районного центра города Сунжа и в 30 км к северо-востоку от города Магас (расстояния по дорогам).",
            history: " в документах начала 1840-х годов часто упоминался в связи с набегами «непокорных» горцев Малой Чечни на «покорные деревни Карабулакского народа», входившие вместе с поселениями Назрановского общества во Владикавказский военный округ.",
            image: "/img/settlements/nesterovskaya.jpg",
            population: 18000
        },
        {
            name: "Алхасте (Алхасты)",
            coords: [43.18, 44.99],  // Координаты [широта, долгота]
            description: "Село расположено на левом берегу реки Асса, в 14 км к юго-западу от районного центра города Сунжа и в 24 км к востоку от города Магас",
            history: "В XIX веке карабулакское селение Алхаст-хи (Алхаст-тхи, также называлось Джантемир-Юрт), в честь которого было названо современное село Алхасты, располагалось в среднем течении небольшой речки Алхаст-тхи, являвшейся левым притоком Ассы, к юго-западу от поста Нестеровского",
            image: "/img/settlements/alhast.jpg",
            population: 5000
        },
        {
            name: "Галашке (Галашки)",
            coords: [43.10, 44.99],  // Координаты [широта, долгота]
            description: "Село расположено на левом берегу реки Асса, в 30 км к юго-западу от районного центра — город Сунжа и в 32 км к юго-востоку от города Магас",
            history: "Название села Галашки объясняют как «место крепости» или «к галаям». Его основали представители тайпа Галай[7], переселившиеся из Галанчожа. В честь села названо галашевское общество (галашевцы). Современные исследователи рассматривают галашевцев как одно из ингушских обществ",
            image: "/img/settlements/galashki.jpg",
            population: 7400
        },
        {
            name: "Мужече (Мужичи)",
            coords: [43.03, 44.99],  // Координаты [широта, долгота]
            description: "Село расположено на левом берегу реки Асса, в 37 км к юго-западу от районного центра — город Сунжа и в 40 км к юго-востоку от города Магас.",
            history: "Аул назван по имени родоначальника тайпа Мужахой — Мужхо. А название села Мужичи в переводе означает — «аул Мужахой»",
            image: "/img/settlements/mujichi.jpg",
            population: 2400
        },
        {
            name: "Товзан-Юхе (Комгарон)",
            coords: [43.05, 44.88],  // Координаты [широта, долгота]
            description: "Оккупированное Ингушское село в Пригородном районе, где частично проживают ингуши",
            history: "В 1944 году, после депортации ингушей в Среднюю Азию, село Таузен-Юрт было передано в состав Северо-Осетинской АССР и переименовано в село Комгарон.",
            image: "/img/settlements/tovzan.jpg",
            population: 1000
        },
        {
            name: "Бекъий-Юрт (Майское)",
            coords: [43.19, 44.72],  // Координаты [широта, долгота]
            description: "Оккупированное Ингушское село в Пригородном районе, где исторически проживают ингуши",
            history: "В начале XIX века на месте современного села, на берегу реки Камбилеевка, было основано селение, именуемое в русских документах и на картах XIX века, как селение Бекая или Бекая Хишилгова (ингуш. Бекъий-Юрт) — ингуша Беки Хашагульгова, праправнука основателя рода Хашагульговых — Хошака (ингуш. Хьошакъа)",
            image: "/img/settlements/bek.jpg",
            population: 7000
        },
        {
            name: "Мочкъий-Юрт (Чермен)",
            coords: [43.15, 44.71],  // Координаты [широта, долгота]
            description: "Оккупированное Ингушское село в Пригородном районе, где исторически проживают ингуши",
            history: "Село основано ингушами и названо в честь Мочко Базоркина, который объединил несколько ингушских хуторов в единое село в 1844 году.",
            image: "/img/settlements/moch.jpg",
            population: 8000
        },
        {
            name: "Шолхи (Октябрьское)",
            coords: [43.05, 44.75],  // Координаты [широта, долгота]
            description: "Оккупированное Ингушское село в Пригородном районе, где исторически проживали ингуши",
            history: "Современное селение было основано ингушами примерно во второй половине XVIII века, когда жители, выделившиеся из округа, известного под названием Большие Ингуши (с центром в Ангуште), образовали округ Малые Ингуши с центром в селении Шолхи",
            image: "/img/settlements/sholhi.jpg",
            population: 10000
        },
        {
            name: "Оалкам (Алкун)",
            coords: [42.97, 45.02],  // Координаты [широта, долгота]
            description: "Предгорное село в Сунженском районе Республики Ингушетия, расположенное по обоим берегам реки Асса.",
            history: "Местность в районе селения была населена ингушами ещё в период позднего Средневековья, и таким образом селение является одним из старейших в предгорной Ингушетии.",
            image: "/img/settlements/alkun.jpg",
            population: 1000
        },
        {
            name: "Берд-Юрт",
            coords: [43.22, 45.11],  // Координаты [широта, долгота]
            description: "Село расположено на правом берегу реки Асса, в 15 км к юго-востоку от районного центра — город Сунжа и в 42 км к северо-востоку от города Магас.",
            history: "Современный населённый пункт был основан в апреле 1999 года и первоначально был предназначен для проживания вынужденных переселенцев, лишившихся крова в Чечне и пожелавших остаться в Республике Ингушетия. Для них в новом селе были выделены земельные участки.",
            image: "/img/settlements/berd.jpg",
            population: 1000
        },
        {
            name: "ТӀой-Юрт (Кантышево)",
            coords: [43.23, 44.64],  // Координаты [широта, долгота]
            description: "Село расположено на правом берегу реки Камбилеевка, в 5 км к западу от районного центра — Назрань и в 14 км к северо-западу от города Магас.",
            history: "В 1858 году властью проводилась политика ликвидации мелких хуторов и образования больших сел. В это время были объединены все близлежащие хутора и образовано Кантышево.",
            image: "/img/settlements/kant.jpg",
            population: 17000
        },
        {
            name: "Заьзгакъонгий-Коа (Зязиков-Юрт)",
            coords: [43.48, 44.77],  // Координаты [широта, долгота]
            description: "Село расположено в Алханчуртской долине, в 14 км к востоку от районного центра — Малгобек и в 50 км к северу от города Магас.",
            history: "В ходе бессистемной нефтедобычи и использования природного ландшафта на территории города Малгобека и Малгобекского района Ингушетии на протяжении нескольких десятилетий, возникли непоправимые нарушения экологии. В результате территория, изначально подверженная оползневой опасности, превратилась практически в зону сплошных оползневых деформаций, что привело к риску проживания людей в данном районе.",
            image: "/img/settlements/zaza.jpg",
            population: 5000
        },
        {
            name: "Алханчурт (Но́вый Реда́нт)",
            coords: [43.48, 44.81],  // Координаты [широта, долгота]
            description: "Село расположено в Алханчуртской долине, в 16 км к юго-востоку от районного центра города Малгобек и в 48 км к северу от города Магас.",
            history: "После депортации чеченцев и ингушей и упразднения Чечено-Ингушской АССР, произошедших в 1944 году, на месте нынешнего села Новый Редант был образован кормосовхоз «Осетия», затем — кормосовхоз «Алханчуртский»[2] (тогда в составе Северо-Осетинской АССР).",
            image: "/img/settlements/redant.jpg",
            population: 6500
        },
        {
            name: "Соагӏапче (Сагопши)",
            coords: [43.48, 44.59],  // Координаты [широта, долгота]
            description: "Село расположено в Алханчуртской долине, на северном склоне Сунженского хребта, к югу от районного центра города Малгобек и в 60 км к северо-западу от города Магас.",
            history: "В 1863 году в гористой местности тогдашней Малой Кабарды, на реке Псыгобже (кабард.-черк. Псыгъуабжэ — серая вода), на расстоянии около 3 км друг от друга появились два новых поселения — аул Цокало Бокова (Верхний Сагопш), заселённый преимущественно переселенцами из Элдархан-калы и аул Аламкача Гатагажева (Нижний Сагопш), заселённый переселенцами из Тарской долины (село Абреково)",
            image: "/img/settlements/sagopshi.jpg",
            population: 13000
        },
        {
            name: "Долакоа (Пседах)",
            coords: [43.47, 44.57],  // Координаты [широта, долгота]
            description: "Населённый пункт расположен у северного подножия Сунженского хребта, в предгорной зоне. ",
            history: "Село основано в 1820 году на территории Малой Кабарды. Земля была выкуплена у малокабардинских князей Бековичей-Черкасских и впоследствии, в 1860-х годах, причислена к Назрановскому обществу. В 1867 году в ингушском военном округе образовали пседахский участок.",
            image: "/img/settlements/psedah.jpg",
            population: 6000
        },
        {
            name: "Инаркъе (Инарки)",
            coords: [43.47, 44.55],  // Координаты [широта, долгота]
            description: "Село расположено на севере Ингушетии, у западной границы Алханчуртской долины, на северном склоне Сунженского хребта (южнее, на границе Ингушетии и Северной Осетии, расположена вершина Мусакай, 872,5 м, северо-западнее, в качестве одного из отрогов Сунженского хребта — гора Арик-Папца, 510,9 м).",
            history: "Ингушское село, упомянутое впервые в 1874 году.",
            image: "/img/settlements/inarki.jpg",
            population: 7800
        },
        {
            name: "Махьмад-хитӀе (Вознесенское)",
            coords: [43.54, 44.75],  // Координаты [широта, долгота]
            description: "Станица расположена на южном склоне Терского хребта, в 20 км к северо-востоку от районного центра города Малгобек и в 54 км к северу от города Магас, столицы республики.",
            history: "Отдельные предметы, найденные в 1950-х годах в окрестностях Вознесенской, относятся к памятникам эпохи неолита, обнаруженным на территории Ингушетии. При проведении земляных работ здесь были случайно обнаружены заготовки каменных клиновидных топоров. Предполагается, что подобные орудия в большинстве своём предназначались для обработки дерева. Находки у станицы Вознесенской датируются V тыс. до н. э.",
            image: "/img/settlements/voz.jpg",
            population: 800
        },
        {
            name: "Аьккхий-Юрт",
            coords: [43.51, 44.86],  // Координаты [широта, долгота]
            description: "Село расположено у южного подножья Терского хребта, в 25 км к востоку от районного центра — Малгобек и в 55 км к северу от города Магас.",
            history: "Большая часть населения исторически - нохчи, проживают тут с самого начала 18 века",
            image: "/img/settlements/aki.jpg",
            population: 1600
        },
        {
            name: "Ангушт (Тарское)",
            coords: [42.97, 44.77],  // Координаты [широта, долгота]
            description: "Оккупированное Ингушское село, где исторически проживают ингуши, именно от этого села произошло самоназвание ингушей в русском языке.",
            history: "О времени основания Ангушта нет точных данных. Известно, что Ангушт изначально не было одним селением, а представляло собой территориальное общество, состоявшее из нескольких мелких родовых селений.",
            image: "/img/settlements/angusht.jpg",
            population: 2800
        },
        {
            name: "Ахки-Юрт (Cунжа)",
            coords: [43.06, 44.82],  // Координаты [широта, долгота]
            description: "Оккупированное Ингушское село, где исторически проживали ингуши.",
            history: "Станица «Сунжа» (Сунженская) была основана в 1859 году на месте ингушского села Ахки-Юрт, основателем которого считается Эжи Ахк из рода (тайпа) Йовлой.",
            image: "/img/settlements/ahksunja.jpg",
            population: 11000
        },
        {
            name: "Эзми",
            coords: [42.83, 44.66],  // Координаты [широта, долгота]
            description: "Оккупированное Ингушское село, где проживали ингуши и расположены древние ингушские башни.",
            history: "На месте села находились аулы Верхний и Нижний Озми (Эзми), основанные ингушами — выходцами из Джейраха в 1643 году.",
            image: "/img/settlements/ezmi.jpg",
            population: 172
        },
        {
            name: "Мохтӏе (Армхи)",
            coords: [42.81, 44.71],  // Координаты [широта, долгота]
            description: "Расположено на левом берегу реки Армхи. Ближайшие населённые пункты с постоянным населением: на севере — село Бейни, на западе — райцентр Джейрах, на востоке — село Ляжгию.",
            history: "Одно из древнейших ингушских сел, где с самой древности проживали предки ингушей.",
            image: "/img/settlements/armhi.jpg",
            population: 300
        },
        {
            name: "Лаьжге (Ляжги)",
            coords: [42.81, 44.73],  // Координаты [широта, долгота]
            description: "Расположено на берегу реки Армхи, к юго-востоку от районного центра Джейрах.",
            history: "Одно из древнейших ингушских сел, тут расположены башни Харсиевых - одного из ингушских родов.",
            image: "/img/settlements/lya.jpg",
            population: 400
        },
        {
            name: "Ольгатӏе (Ольгетти)",
            coords: [42.80, 44.75],  // Координаты [широта, долгота]
            description: "Расположено на берегу реки Армхи, к юго-востоку от районного центра Джейрах.",
            history: "Достоверных сведений о возникновении села, происхождении его названия нет. Сведения легендарного толка содержатся в художественном романе-эпопее писателя Идриса Базоркина «Из тьмы веков». В действие романа вплетено предание о том, что в примерно середине XIX века за убийство по неосторожности род Эги передал роду Гойтемира землю по приговору некоего Тантала. За это Тантал получил от рода Гойтемира часть переданной земли себе в дар и основал поселение Ольгетты (ещё один вариант названия), перевезя туда свой род из Грузии. Вместе с тем, Базоркин мог пользоваться не дошедшими до наших дней архивными документами и свидетельствами.",
            image: "/img/settlements/olg.jpg",
            population: 500
        },
    ];
    
    // Культурные объекты
    const culturalSites = [
        {
            name: "Башенный комплекс Эгикал",
            coords: [42.83, 44.92],
            description: "Один из крупнейших средневековых башенных комплексов Ингушетии.",
            history: "Эгикал - один из крупнейших средневековых башенных комплексов Ингушетии, датируемый XIII-XVII веками.",
            image: "/img/cultural/egikal.jpg"
        },
        {
            name: "Башня Согласия",
            coords: [43.17, 44.80],
            description: "Современная башня в Магасе, построенная по образцу традиционных ингушских башен.",
            history: "Башня Согласия была построена в 2013 году в столице Ингушетии городе Магасе.",
            image: "/img/cultural/tower-of-concord.jpg"
        },
        {
            name: "Башенный комплекс Вовнушки",
            coords: [42.80, 44.99],
            description: "Уникальный средневековый комплекс боевых башен, построенный на скальных утесах.",
            history: "Вовнушки - уникальный комплекс средневековых боевых башен, построенный на труднодоступных скальных утесах в Джейрахском ущелье.",
            image: "/img/cultural/vovnushki.jpg"
        },
        {
            name: "Башенный комплекс Хамхи",
            coords: [42.82, 44.93],
            description: "Древний башенный комплекс, один из крупнейших в горной Ингушетии.",
            history: "Хамхи - один из крупнейших средневековых башенных комплексов в горной Ингушетии.",
            image: "/img/cultural/khamkhi.jpg"
        },
        {
            name: "Башенный комплекс Таргим",
            coords: [42.84, 44.94],  // Координаты [широта, долгота]
            description: "На территории города-поселения имеется архитектурный комплекс «Таргим», представленный множеством исторических объектов: древние циклопические жилища башенного типа, 4 боевые башни, 2 — полубоевые и более 20 жилых башен, а также 19 склеповых могильников, 2 мавзолея и 5 святилищ.",
            history: "История повествует, что построили крепость примерно в 15-17-м веках, и именно отсюда началось массовое расселение ингушей по другим горным локациям. Хотя по некоторым данным, основание этого легендарного поселения восходит еще к двенадцатому столетию.",
            image: "/img/cultural/targim.jpg"
        },
        {
            name: "Башенный комплекс Ний",
            coords: [42.83, 45.00],  // Координаты [широта, долгота]
            description: "Один из известнейших в стране. Это древний город, украшающий собой покатый склон горы. Старинные башни возвышаются на фоне суровой скальной стены – с таким грозным соседом они выглядят еще более величественно.",
            history: "С южной стороны непосредственно к селению Ний примыкала протяжённая высокая каменная заградительная стена с широкими арочными запирающимися воротами. Здесь обычно постоянно дежурила хорошо вооружённая местная стража, контролирующая пролегавшую военную, торгово-транспортную дорогу («Дорогу ингушей») и взимающая за проход плату (тканями, оружием и пр.). В стене были устроены специальные боевые площадки, сводчатые оконные проёмы, ниши, бойницы для стрельбы и наблюдения.",
            image: "/img/cultural/niy.jpg"
        }, 
        {
            name: "Башенный комлпкс Цори",
            coords: [42.81, 45.09],  // Координаты [широта, долгота]
            description: "Cредневековый замковый ансамбль в туманистой местности.",
            history: "Считается, что родоначальниками крепости было ингушское общество цоринцев, приобретшее в 19-м веке небывалое влияние на территории республики. Историки считают, что в это время происходило единение ингушского народа как этноса, и не последнюю роль в этом процессе сыграл башенный комплекс Цори. Исторические документы свидетельствуют о том, что в 1832 году, в период Кавказской войны, башенный комплекс Цори был обстрелян из армейских пушек.",
            image: "/img/cultural/cori.jpg"
        },
        {
            name: "Башенный комплекс Гаьги Г1алаш",
            coords: [42.85, 44.93],  // Координаты [широта, долгота]
            description: "Архитектурный комплекс на вершине и склонах мысовидного выступа правого берега р. Ассы, в 1,4 км севернее Таргима.",
            history: "Достоверных источников о происхождении комплекса нету, однако точно можно сказать, что башни были предназначены для боевых действий, и были неким форпостом в Ассинском ущелье.",
            image: "/img/cultural/gagi.jpg"
        },
        {
            name: "Башенный комплекс Бархане",
            coords: [42.84, 44.91],  // Координаты [широта, долгота]
            description: "Башенный комплекс к северу от Эгикала. Состоит из двух замков, в каждом сохранилась боевая башня.",
            history: "Местные жители данного поселения в позднем средневековье специализировались на возведении наиболее совершенных и сложных в техническом исполнении каменных построек.",
            image: "/img/cultural/barhane.jpg"
        },
        {
            name: "Верхний Кхарт",
            coords: [42.83, 44.87],  // Координаты [широта, долгота]
            description: "Башенный комплекс Картоевых",
            history: "Башня Картоевых является одной из самых высоких и красивых в горной Ингушетии. Судя по работе Д. Чахкиева, имеет 6 этажей и достигает в высоту более 28 метров. Вторую, идентичную ей башню (с. Верхний Кхарт) взорвали во время экспедиции Розена в 1832 г. Эти два замковых комплекса (Кхарт и Верхний Кхарт) соединялись мощной заградительной стеной, от которой уже ничего не осталось, как и от большинства жилых башен и других построек. Выше Кхарта находится родовое святилище — Дялите (полуразрушенное), являвшееся одним из главных духовных центров ГIалгIайче. Следует отметить, что центр культа Тушоли, до того, как переместиться в с. Ког (Кок), находился в с. Кхарт.",
            image: "/img/cultural/khart.jpg"
        },
        {
            name: "Башенный комплекс Кост (Къест, Къоаст)",
            coords: [42.81, 44.88],  // Координаты [широта, долгота]
            description: "Кост (Къест, Къоаст) — башенный поселок на отроге горы Гайкомд (Цей-Лоам), хребте Такан-дук, который отделяет Галгаевское ущелье (Эгикал, Оздик, Лейми) от ущелья Мужиг (Гаппи, Цоли, Кяхк). Сегодня в нем сохраняются развалины боевой и шести жилых башен с различными пристройками периода позднего средневековья.",
            history: "Из поселка происходит фамилия Костоевых (и других), которые два столетия назад активно добывали и умело обрабатывали свинцовые руды, служившие для приготовления пуль.",
            image: "/img/cultural/khost.jpg"
        },
        {
            name: "Башенный комплекс Бишт",
            coords: [42.81, 44.86],  // Координаты [широта, долгота]
            description: "Башенный поселок у начала Тумгойского ущелья. Насчитывает свыше 80 башенных объектов, которые в настоящее время восстанавливаются. По окончании реконструкции в Биште будет 4 боевых башни.",
            history: "Один из древнейших башенных комплексов",
            image: "/img/cultural/bisht.jpg"
        },
        {
            name: "Башенный комплекс Салги",
            coords: [42.79, 44.82],  // Координаты [широта, долгота]
            description: "Башенный поселок замкового типа на гребне горного кряжа у начала Салгинского (Чулхойского) ущелья, на правом берегу речки Чулхи. Поселок занимает стратегически важное положение, запирая проход к селениям ущелья по нижней тропе, выходящей в сторону Грузии.",
            history: "По легенде, Салги был построен выходцами из поселка Маготе, расположенного рядом на горном хребте. Из Салги вышли Салгиевы, Салгиреевы, Додовы, Эльжаркиевы, Марзиевы, Дзауровы, Дударовы и другие ингушские фамилии, относящиеся к тейпу Салгхой. В позднем средневековье Салги являлся административно-политическим и культурным центром Чулхойского ущелья.",
            image: "/img/cultural/salgi.jpg"
        },
        {
            name: "Башенный комплекс Гу",
            coords: [42.80, 44.82],  // Координаты [широта, долгота]
            description: "Небольшой башенный поселок замкового типа на вершине горного мыса из черного слоистого сланца в центре Салгинского (Чулхойского) ущелья, северо-восточнее Салги. Внизу под холмом протекает речка Чулхи, в которую впадает небольшой ручей, берущий начало вверху с отрогов Скалистого хребта. Она протекает по глубокому оврагу. Поселок небольшой, но занимает выгодное стратегическое положение. В состав Гу входят две полубоевые башни и восемь жилых, с различными пристройками, которые с помощью оборонительной стены составляли единый замковый комплекс позднего средневековья. На окраине поселка расположен склеп и небольшое мусульманское кладбище.",
            history: "Из Гу вышли фамилии тейпа Гухой (Гухоевы, Гадиевы и др.). По преданию, земля для Гу была выделена жителями поселка Салги, с условием что новопоселенцы не построят на земле предков боевую башню. Обещание было сдержано, в Гу возведены лишь две крупные полубоевые башни. Местные жители считались умелыми животноводами, мастерами по обработке шерсти и кожи животных. Согласно современным исследованиям Умалата Гадиева, директора Археологического центра им. Е.И.Крупнова, есть предположение, что Гу основано выходцами из поселка Ханикал, которое в свою очередь построено потомками легендарного Маго из Маготе. По сведениям, которые собрал Умалат Гадиев, у праправнука Маго - Гия, родоночальника тейпа Тумгой, было три жены. Одна из них была бездетная, у второй и третьей было потомство. От второй идут Гухоевы (Гувхой), от третьей Тумгоевы. Вначале Гухоевы основали поселок Ханикал (в 2 км от Маготе), однако из-за эпидемии холеры было решено купить земли неподалеку от Маготе, рядом с поселком Салги (за землю было заплачено не менее 100 голов крупного рогатого скота).",
            image: "/img/cultural/gu.jpg"
        },
        {
            name: "Башенный поселок Шоан",
            coords: [42.79, 44.77],  // Координаты [широта, долгота]
            description: "Башенный поселок к востоку от Эрзи. Состоит из двух частей, которые разделяет речка и автодорога. Боевая башня комплекса сильно повреждена.",
            history: "По рассказам старожилов, в Шоане жили мастера-оружейники, девушки славились ткацким мастерством, умением вышивать золотом, серебром, бисером. В окрестностях селения расположен «Городок мертвых» («Мохде»), Шоанское святилище богини весны Тушоли, на восточной стороне Шоана — два языческих столпообразных святилища.",
            image: "/img/cultural/shoan.jpg"
        },
        {
            name: "Боевые башни Эрзи",
            coords: [42.80, 44.75],  // Координаты [широта, долгота]
            description: "Башенный комплекс Эрзи – один из крупнейших башенных комплексов Ингушетии. Он находится в Джейрахском районе, на оконечности горного кряжа в Джейрахском ущелье и включает в себя 8 боевых, 2 полубоевые и 47 жилых башен, опоясанных каменными оборонительными стенами.",
            history: "Историки датируют строительство комплекса XVII веком. В отличие от других боевых башен, встречающихся на Кавказе, боевые башни в Ингушетии более узкие.",
            image: "/img/cultural/erzi.jpg"
        },
        {
            name: "Галихал ,Сторожевая Башня Рода Хадзиевых",
            coords: [42.82, 44.76],  // Координаты [широта, долгота]
            description: "Сторожевая башня в северной части гор, принадлежит роду Хадзиевых",
            history: "Достоверной истории нету, однако предполагается, что данная башня была как сторожевой, так и смотровой, с помощью нее жители могли узнать о появлении гостей на своих землях.",
            image: "/img/cultural/hadzi.jpg"
        },
        {
            name: "Башенный Комплекс Мецхал",
            coords: [42.82, 44.73],  // Координаты [широта, долгота]
            description: "По народной этимологии, название состоит из двух частей — меца (голод, голодный) и хала (трудный), и переводится как «трудный (тяжёлый) голод». По предании, на месте Мецхала проживала когда-то «благодатная птичка» — фаьра хьазилг. Якобы её гнездо разорили какие-то плохие люди, и впоследствии она улетела в Грузию. С тех пор, в Мецхале исчезла земная благодать. Возможно, топоним связан с грузинским названием ласточки — мерцхал или с древней столицы Грузии — Мцхета.",
            history: "Вместе с селами Таргим, Эгикал, Хамхи и Фалхан, Мецхал считается одной из исторических колыбелей ингушского народа. Ингушские предания относят возникновение этих сёл к времён царствовании Тамары (XII в.)",
            image: "/img/cultural/mechal.jpg"
        },
        {
            name: "Башенный комплекс Фалхан",
            coords: [42.82, 44.73],  // Координаты [широта, долгота]
            description: "Аул Фалхан, расположенный в Джейрахском районе, покинут людьми уже очень давно. В данный момент башенный комплекс состоит из полуразрушенных бастионов и жилых сооружений. До начала XX века их насчитывалось двенадцать + четыре боевые и полубоевые башни.",
            history: "Башни Фалхан, если верить преданию, основаны родом Ферхаста, у которого было три сына. Произошло это событие примерно в 12-м веке, соответственно, аул считается очень древним. Раньше здесь царствовало племя гамнакан, причем довольно воинственное, поэтому построить на скале башенный комплекс было делом крайне непростым.",
            image: "/img/cultural/falhan.jpg"
        },
        {
            name: "Башенный комплекс Эбан",
            coords: [42.82, 44.69],  // Координаты [широта, долгота]
            description: "За селением Джейрах на правой стороне ущелья чернеют над крутым обрывом заросшие бурьяном остатки замкового комплекса Эбан. Некогда в этом ауле возвышались 4 боевых и несколько жилых башен.",
            history: "Селение было разрушено в 1830 году отрядом царской армии под командованием генерал-майора Абхазова. Из преданий о селении Эбан: «…Эбан был взят врагами и разорен дотла. Только один мальчик остался в живых, да и тот был брошен с высоты берега, но он не погиб, хотя получил девять ран. Мальчик этот был поднят и взят женщиной, возвращавшейся с мельницы в аул ХIарп. Ему дали имя Циск (кошка). А назвали его так, потому что он был живуч как кошка, хотя и имел девять ран.",
            image: "/img/cultural/eban.jpg"
        },
        {
            name: "Башня Цуровых",
            coords: [42.82, 44.68],  // Координаты [широта, долгота]
            description: "Одна из древнейших башен, принадлежавших Цуровым.",
            history: "Первое упоминание о башне Цуровых датируется XVIII веком. О корнях, истоках рода Цуровых сохранилось немало преданий и легенд.",
            image: "/img/cultural/curov.jpg"
        },
        {
            name: "Памятник жертвам российско-осетинского терроризма 1992 года",
            coords: [43.15, 44.98],  // Координаты [широта, долгота]
            description: "Скульптура изображающая пострадавших во время российского и осетинского террора на территории Пригородного района, когда коренные ингуши были вынуждены покинуть дома, а культурное наследие было уничтожено осетинскими боевиками.",
            history: "Памятник установленный Полонкоевым Ибрагимом в память о погибших в трагедии 1992 года",
            image: "/img/cultural/pam.jpg"
        },
        {
            name: "Мемориал памяти и славы",
            coords: [43.20, 44.77],  // Координаты [широта, долгота]
            description: "Мемориальный комплекс в Насыр-Кортском административном округе Назрани, посвященный важнейшим памятным датам и событиям Ингушетии.",
            history: "Строительство мемориала — музея памяти жертв сталинских репрессий «Девять башен» по проекту Мурада Полонкоева началось в 1996 году. Мемориал был открыт 23 февраля 1997 года, к 53-й годовщине трагедии ингушского и других депортированных народов СССР.",
            image: "/img/cultural/memor.jpg"
        },
        {
            name: "Ингушский музей краеведения им. Т. Х. Мальсагова",
            coords: [43.24, 44.76],  // Координаты [широта, долгота]
            description: "Учреждение культуры в Назрани, Ингушетия, созданное в 1972 году и имеющее нынешний статус с 1993 года.",
            history: "В 1972 году (по другим данным — в 1973 году) году Туган Хаджимохович Мальсагов (1912—1983) создал народный музей на основе собранных им лично материалов об ингушах — участниках Второй мировой войны[2]. Он начал собирать экспонаты для этого музея, ещё будучи в депортации (1943—1957). После возвращения в Ингушетию он ездил по сёлам, собирая документальные свидетельства",
            image: "/img/cultural/muz.jpg"
        },
        {
            name: "Музей изобразительных искусств",
            coords: [43.32, 44.91],  // Координаты [широта, долгота]
            description: "В настоящее время фонды музея насчитывают более 3000 экспонатов.",
            history: "Государственный музей изобразительных искусств Республики Ингушетия основан 27 мая 1993 года.",
            image: "/img/cultural/izo.jpg"
        },
    ];
    
    // Религиозные объекты
    const religiousSites = [
        {
            name: "Тхаба-Ерды",
            coords: [42.81, 44.85],
            description: "Древнейший христианский храм на территории Ингушетии, датируемый VIII-IX веками.",
            history: "Тхаба-Ерды - древнейший христианский храм на территории Ингушетии, датируемый VIII-IX веками.",
            image: "/img/religious/thaba-erdy.jpg"
        },
        {
            name: "Джума-мечеть Назрань",
            coords: [43.23, 44.77],
            description: "Центральная мечеть города Назрань, вмещает более 3000 верующих.",
            history: "Названа она в честь Мухамад-Басира Оздоева, погибшего во время осетино-ингушского конфликта в 1992 году. Первым имамом мечети являлся Оздоев Мухамад-Басир",
            image: "/img/religious/djuma.jpg"
        },
        {
            name: "Центральная мечеть «Сердце Кавказа»",
            coords: [43.16, 44.80],
            description: "Главная мечеть столицы Ингушетии.",
            history: "Современная мечеть Ингушетии построенная недавно",
            image: "/img/religious/magas-mosque.jpg"
        },
        {
            name: "Мечеть Экажевская",
            coords: [43.21, 44.82],  // Координаты [широта, долгота]
            description: "Одна из крупнейших мечетей в Ингушетии",
            history: "центральная мечеть Экажево была построена на месте предыдущей, сгоревшей в январе 2006 года. Жители села собрали средства и в июне 2010 была открыто новое здание. Его размеры впечатляют - 60 на 18 м, три этажа, минареты высотой 46 метров, она является высотной доминантой не только Экажево, но и соседних сел. Вместимость мечети - около 4500 человек.",
            image: "/img/religious/mosek.jpg"
        },
        {
            name: "Мечеть в Джейрахе",
            coords: [42.82, 44.67],  // Координаты [широта, долгота]
            description: "В годы Советской власти на Северном Кавказе мечеть была закрыта, а здание отдано под клуб.",
            history: "Мечеть сельского поселения Джейрах была построена в 1930году.",
            image: "/img/religious/djeirah.jpg"
        },
        {
            name: "Центральная мечеть в Малгобеке",
            coords: [43.51, 44.58],  // Координаты [широта, долгота]
            description: "Находится мечеть по улице Кожедуба.",
            history: "Центральная мечеть города Малгобек построена в 1989 году. Инициатором ее строительства являлся Гуражев Хасан-хаджи, который стал первым имамом этой мечети.",
            image: "/img/religious/malgo.jpg"
        },
        {
            name: "Центральная мечеть с.п. Верхние Ачалуки",
            coords: [43.37, 44.73],  // Координаты [широта, долгота]
            description: "Центральная мечеть сельского поселения Верхние Ачалуки.",
            history: "Была построена в 1920 году на пожертвования жителей села. Первым имамом мечети являлся Чапанов Алаудин Султанович. Мечеть носит имя шейха Чапанова Исхака-муллы Осмаевича.",
            image: "/img/religious/acha.jpg"
        },
        {
            name: "Центральная Мечеть в Новом Реданте",
            coords: [43.47, 44.80],  // Координаты [широта, долгота]
            description: "Мечеть сельского поселения Новый Редант.",
            history: "была построена в 1995 году под руководством жителей села Албакова Юнуса, Илиева Магомеда, Хамхоева Ахмеда. Первым имамом мечети являлся Льянов Уматгирей.",
            image: "/img/religious/redan.jpg"
        },
        {
            name: "Назрановская Мечеть",
            coords: [43.23, 44.80],  // Координаты [широта, долгота]
            description: "Мечеть на улице Албогачиева",
            history: "Одна из крупнейших построенных современности мечетей Ингушетии.",
            image: "/img/religious/nazranov.jpg"
        },
        {
            name: "Мечеть с.п. Сурхахи им. Шейха Батал-Хаджи",
            coords: [43.20, 44.90],  // Координаты [широта, долгота]
            description: "Мечеть им. Шейха Батал-Хаджи сельского поселения Cурхахи.",
            history: "Сурхахи была построена в 2007 году на пожертвования верующих.",
            image: "/img/religious/batl.jpg"
        },
    ];
    
    // Добавляем города на карту
    cities.forEach(city => {
        const marker = L.marker(city.coords, {icon: cityIcon})
            .bindPopup(createExtendedPopupContent(city));
        
        citiesLayer.addLayer(marker);
        
        // Добавляем город в список
        const cityItem = document.createElement('div');
        cityItem.className = 'place-item';
        cityItem.innerHTML = `<div class="place-name">${city.name}</div><div class="place-type">Город</div>`;
        cityItem.addEventListener('click', function() {
            map.setView(city.coords, 13);
            marker.openPopup();
        });
        document.getElementById('cities-list').appendChild(cityItem);
    });
    
    // Добавляем села на карту
    villages.forEach(village => {
        const marker = L.marker(village.coords, {icon: villageIcon})
            .bindPopup(createExtendedPopupContent(village));
        
        villagesLayer.addLayer(marker);
        
        // Добавляем село в список
        const villageItem = document.createElement('div');
        villageItem.className = 'place-item';
        villageItem.innerHTML = `<div class="place-name">${village.name}</div><div class="place-type">Село</div>`;
        villageItem.addEventListener('click', function() {
            map.setView(village.coords, 13);
            marker.openPopup();
        });
        document.getElementById('villages-list').appendChild(villageItem);
    });
    
    // Добавляем культурные объекты на карту
    culturalSites.forEach(site => {
        const marker = L.marker(site.coords, {icon: culturalIcon})
            .bindPopup(createExtendedPopupContent(site));
        
        culturalLayer.addLayer(marker);
        
        // Добавляем объект в список
        const siteItem = document.createElement('div');
        siteItem.className = 'place-item';
        siteItem.innerHTML = `<div class="place-name">${site.name}</div><div class="place-type">Культурный объект</div>`;
        siteItem.addEventListener('click', function() {
            map.setView(site.coords, 13);
            marker.openPopup();
        });
        document.getElementById('cultural-list').appendChild(siteItem);
    });
    
    // Добавляем религиозные объекты на карту
    religiousSites.forEach(site => {
        const marker = L.marker(site.coords, {icon: religiousIcon})
            .bindPopup(createExtendedPopupContent(site));
        
        religiousLayer.addLayer(marker);
        
        // Добавляем объект в список
        const siteItem = document.createElement('div');
        siteItem.className = 'place-item';
        siteItem.innerHTML = `<div class="place-name">${site.name}</div><div class="place-type">Религиозный объект</div>`;
        siteItem.addEventListener('click', function() {
            map.setView(site.coords, 13);
            marker.openPopup();
        });
        document.getElementById('religious-list').appendChild(siteItem);
    });
    
    // Добавляем слои на карту
    citiesLayer.addTo(map);
    villagesLayer.addTo(map);
    culturalLayer.addTo(map);
    religiousLayer.addTo(map);
    
    // Обработчики чекбоксов для включения/выключения слоев
    document.getElementById('layer-villages').addEventListener('change', function(e) {
        if (e.target.checked) {
            map.addLayer(citiesLayer);
            map.addLayer(villagesLayer);
        } else {
            map.removeLayer(citiesLayer);
            map.removeLayer(villagesLayer);
        }
    });
    
    document.getElementById('layer-cultural').addEventListener('change', function(e) {
        if (e.target.checked) {
            map.addLayer(culturalLayer);
        } else {
            map.removeLayer(culturalLayer);
        }
    });
    
    document.getElementById('layer-religious').addEventListener('change', function(e) {
        if (e.target.checked) {
            map.addLayer(religiousLayer);
        } else {
            map.removeLayer(religiousLayer);
        }
    });
    
    // Добавляем кнопку для поиска местоположения пользователя
    L.control.locate({
        position: 'topleft',
        strings: {
            title: "Показать моё местоположение"
        },
        locateOptions: {
            enableHighAccuracy: true
        }
    }).addTo(map);
    
    // Добавляем масштаб на карту
    L.control.scale({
        imperial: false, // Показывать только метрическую систему
        position: 'bottomleft'
    }).addTo(map);
});
